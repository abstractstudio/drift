<html>
    <head>
        
        <!-- Title and includes. -->
        <title>Chincoteague Drift</title>
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=0">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="styles.css">
        
        <!-- Engine setup. -->
        <script type="text/javascript">
            var ENGINE = "abstractengine/";
            var engine;
            function start() {
                require(["drift.js"], function() {
                    console.log("Loaded Drift");
                    var canvas = document.getElementById("canvas"); 
                    engine = new Drift(canvas);
                    engine.start();
                });
            }
        </script>
        
        <!-- Engine startup. -->
        <script type="text/javascript" src="abstractengine/setup.js"></script>
    
    </head>
    <body>
        
        <!-- The canvas for the engine. -->
        <canvas width=600 height=690 id="canvas">HTML5 unavailable</canvas>
        
        <!-- The description of drift. -->
        <div id="description">
        	<p>
        		<b>Scoreboard</b>
				<table id="scoreboard">
					
				</table>
        	</p>
            <p>
                <b>About</b><br>
                Chincoteague Drift is a skill-based boating game where you must use the slow, 
                trundling drift of the research barge to dodge the dangerous obstacles. See how far you can drift!
            </p>
            <p>
                <b>Gameplay</b><br>
                Use <b>A</b> or <b>&larr;</b> to turn left and <b>D</b> or <b>&rarr;</b> to turn right. <b>W</b> and <b>&rarr;</b> boost the boat.
                Bonuses are awarded for narrowly skirting around obstacle.
            </p>
            <p>
                <b>Features</b><br>
                Realistic drift physics&nbsp;&bull;
                Particle effects&nbsp;&bull;
                Boost balance&nbsp;&bull;
                Skill detection&nbsp;&bull;
                Impossibility prevention&nbsp;&bull;
                Better pause&nbsp;&bull;
                Firefox support&nbsp;&bull;
                Better webpage layout&nbsp;&bull;
                Running in the 90's&nbsp;&bull;
                I love you&nbsp;&bull;
                Pew pew<br>
            </p>
            <p>
                <b>Credits</b><br>
                Art by Dylan Kim and Noah Kim<br>
                Developed for the Abstract Engine<br>
                By Noah Kim and Arman Siddique as <a href="https://github.com/abstractstudio">Abstract Studio</a><br>       
            </p>
        </div>
        
        <!-- A little button. -->
        <div id="button" onclick="javascript: toggleDescription();">
            &darr;
        </div>
        
        <!-- Scoreboard. -->
		<script type="text/javascript">
			function getScoreboards() {
				var request = new XMLHttpRequest();
				request.onreadystatechange = function() {
					if (request.readyState == 4 && request.status == 200) {
						var scoreboard = JSON.parse(request.responseText);
						var element = document.getElementById("scoreboard");
						var html = "";
						for (var i = 0; i < scoreboard.length; i++) {
							html += "<tr><td class=\"right\">" + scoreboard[i][0] + "</td>";
							html += "<td>" + scoreboard[i][1] + "</td></tr>";
						}
						element.innerHTML = html;
					}
				};
				request.open("GET", "scoreboard.php", true);
				request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
				var data = "mode=normal";
				request.send(data);
			}
			getScoreboards();
		</script>
        
        <!-- Pretty formatting. -->
        <script type="text/javascript">
            var hidden = false;
            var description = document.getElementById("description");
            var button = document.getElementById("button");
            
            function hideDescription() {
                hidden = true;
                description.style.transform = "";
                button.style.transform = "";
            }
            
            function showDescription() {
            	getScoreboards();
                hidden = false;
                description.style.transform = "translate(0, -100%)";
                button.style.transform = "rotate(180deg)";
            }
            
            function toggleDescription() {
                if (hidden) showDescription();
                else hideDescription();
            }
            
            document.addEventListener("mousewheel", function(e) {
                if (e.wheelDelta > 0) hideDescription();
                else if (e.wheelDelta < 0) showDescription();
            });
        </script>        
        
    </body>
</html>
